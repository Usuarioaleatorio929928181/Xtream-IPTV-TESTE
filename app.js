/* full JS pasted from user */